<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />
  <title>Pizza Hut - My Account</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
  <link rel="stylesheet" href="style.css"> 
  <script src="https://unpkg.com/libphonenumber-js@1.10.14/bundle/libphonenumber-js.min.js"></script>
  <style>
    :root { --brand-red: #D71921; }
    body { background-color: #f9fafb; }
    .tab-button {
        transition: all 0.2s ease-in-out;
        border-bottom: 3px solid transparent;
        padding: 0.75rem 0.5rem;
        color: #6b7280;
    }
    .tab-button.active {
        border-bottom-color: var(--brand-red);
        color: var(--brand-red);
        font-weight: 600;
    }
    .tab-content { display: none; animation: fadeIn 0.4s ease; }
    .tab-content.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    .address-card {
        background-color: white; border-radius: 0.75rem;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        border-left: 4px solid transparent; transition: all 0.2s;
        border: 1px solid #e5e7eb;
    }
    .address-card:hover { border-left-color: #f87171; transform: translateY(-2px); }
    .address-card.default { border-left-color: var(--brand-red); border-color: var(--brand-red); }
    .address-card.default .default-badge { display: inline-block; }
    .default-badge { display: none; }
    
    .spinner {
        display: none;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-top: 2px solid #fff;
        border-radius: 50%;
        width: 1.25rem;
        height: 1.25rem;
        animation: spin 1s linear infinite;
    }
    button:disabled .spinner { display: inline-block; }
    button:disabled .btn-text { visibility: hidden; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
  </style>
</head>
<body class="min-h-screen flex flex-col">

  <header class="bg-white text-gray-800 p-4 shadow-sm sticky top-0 z-20">
    <div class="container mx-auto flex justify-between items-center max-w-4xl">
      <a href="menu.html" class="text-xl sm:text-2xl font-bold hover:opacity-80 transition flex items-center gap-2">
          <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d2/Pizza_Hut_logo.svg/2560px-Pizza_Hut_logo.svg.png" alt="Pizza Hut Logo" class="h-8" />
      </a>
        <a href="cart.html" class="text-lg relative hover:opacity-80 transition">
            <i class="fas fa-shopping-cart text-red-600"></i>
            <span id="cart-count-nav" class="absolute -top-2 -right-2 bg-yellow-400 text-red-800 text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center">0</span>
        </a>
    </div>
  </header>

  <main class="container mx-auto p-4 sm:p-6 mt-4 max-w-2xl flex-grow">
    <h1 id="profile-main-title" class="text-3xl font-bold mb-6 text-gray-800" data-translate="profile_title_main">My Account</h1>

    <div class="border-b border-gray-200 mb-6">
        <nav class="-mb-px flex space-x-6" aria-label="Tabs">
            <button class="tab-button active" data-tab="personal-info"><i class="fas fa-user-edit mr-2"></i><span data-translate="tab_personal_info">Personal Info</span></button>
            <button class="tab-button" data-tab="addresses"><i class="fas fa-map-marker-alt mr-2"></i><span data-translate="tab_my_addresses">My Addresses</span></button>
            <button class="tab-button" data-tab="settings"><i class="fas fa-cog mr-2"></i><span data-translate="tab_settings">Settings</span></button>
        </nav>
    </div>

    <div>
        <div id="personal-info" class="tab-content active">
            <div class="bg-white p-6 rounded-xl shadow-xl">
                <form id="profile-form" class="space-y-4">
                    <div>
                        <label for="profile-email" class="block text-sm font-medium text-gray-700">Email Address</label>
                        <input type="email" id="profile-email" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed" readonly />
                    </div>
                    <div>
                        <label for="profile-name" class="block text-sm font-medium text-gray-700" data-translate="customer_name_label">Full Name</label>
                        <input type="text" id="profile-name" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg" required />
                    </div>
                    <div>
                        <label for="profile-phone" class="block text-sm font-medium text-gray-700" data-translate="phone_number_label">Phone Number</label>
                        <input type="tel" id="profile-phone" class="mt-1 block w-full p-3 border border-gray-300 rounded-lg" />
                    </div>
                    <button type="submit" id="update-profile-btn" class="w-full bg-green-600 hover:bg-green-700 text-white text-lg font-semibold rounded-lg px-6 py-3 shadow-md transition flex items-center justify-center relative">
                        <span class="btn-text" data-translate="update_profile_button">Update Profile</span>
                        <div class="spinner absolute"></div>
                    </button>
                </form>
            </div>
        </div>

        <div id="addresses" class="tab-content">
            <div id="addresses-list" class="space-y-4"></div>
            <div id="loading-state" class="text-center py-10"><i class="fas fa-spinner fa-spin text-red-600 text-4xl"></i></div>
            <div id="no-addresses-state" class="hidden text-center bg-white p-8 rounded-lg shadow-md">
                <i class="fas fa-map-marker-alt text-4xl text-gray-400 mb-4"></i>
                <h2 class="text-xl font-bold text-gray-800" data-translate="no_addresses_title">No Saved Addresses</h2>
                <p class="text-gray-600 mt-2" data-translate="no_addresses_subtitle">Click the button below to add your first address.</p>
            </div>
            <button id="add-new-btn" class="mt-6 w-full bg-red-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-red-700 transition flex items-center justify-center">
                <i class="fas fa-plus-circle mr-2"></i> <span data-translate="add_new_address_btn">Add New Address</span>
            </button>
        </div>

        <div id="settings" class="tab-content">
             <div class="bg-white p-6 rounded-xl shadow-xl space-y-6">
                <div>
                    <h3 class="font-semibold text-lg text-gray-800" data-translate="setting_change_password">Change Password</h3>
                    <p class="text-sm text-gray-500 mb-4" data-translate="setting_change_password_desc">Update your login credentials</p>
                    <form id="change-password-form" class="space-y-3 border-t pt-4">
                        <div>
                            <label for="current-password" class="block text-sm font-medium text-gray-700" data-translate="form_label_current_password">Current Password</label>
                            <input type="password" id="current-password" required class="mt-1 w-full p-2 border border-gray-300 rounded-md">
                        </div>
                        <div>
                            <label for="new-password" class="block text-sm font-medium text-gray-700" data-translate="form_label_new_password">New Password</label>
                            <input type="password" id="new-password" required class="mt-1 w-full p-2 border border-gray-300 rounded-md">
                        </div>
                         <div>
                            <label for="confirm-password" class="block text-sm font-medium text-gray-700" data-translate="form_label_confirm_password">Confirm New Password</label>
                            <input type="password" id="confirm-password" required class="mt-1 w-full p-2 border border-gray-300 rounded-md">
                        </div>
                        <button type="submit" id="update-password-btn" class="w-full bg-gray-700 hover:bg-gray-800 text-white font-semibold rounded-lg px-6 py-2.5 shadow-md transition flex items-center justify-center relative">
                             <span class="btn-text" data-translate="form_button_update_password">Update Password</span>
                             <div class="spinner absolute"></div>
                        </button>
                    </form>
                </div>
                 <div class="border-t pt-6 space-y-3">
                     <a href="my-orders.html" class="flex justify-between items-center p-4 rounded-lg hover:bg-gray-100 transition">
                         <div><h3 class="font-semibold text-gray-800" data-translate="setting_my_orders">My Orders</h3><p class="text-sm text-gray-500" data-translate="setting_my_orders_desc">Track current orders</p></div><i class="fas fa-chevron-right text-gray-400"></i>
                     </a>
                     <a href="delete-account.html" class="flex justify-between items-center p-4 rounded-lg hover:bg-red-50 transition">
                         <div><h3 class="font-semibold text-red-600" data-translate="setting_delete_account">Delete Account</h3><p class="text-sm text-red-400" data-translate="setting_delete_account_desc">Permanently remove your account</p></div><i class="fas fa-chevron-right text-red-400"></i>
                     </a>
                 </div>
            </div>
        </div>
    </div>
  </main>

  <div id="address-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 hidden" role="dialog" aria-modal="true" aria-labelledby="modal-title">
    <div class="bg-white rounded-lg shadow-xl w-full max-w-md" id="address-modal-content">
        <form id="address-form" class="p-6 space-y-4">
            <h2 id="modal-title" class="text-2xl font-bold text-gray-800">Add New Address</h2>
            <div>
                <label for="address-label" class="text-sm font-medium text-gray-700">Label (e.g., Home, Work)</label>
                <input type="text" id="address-label" required class="mt-1 w-full p-2 border rounded-md">
            </div>
            <div>
                <label for="address-street" class="text-sm font-medium text-gray-700">Street Address</label>
                <input type="text" id="address-street" required class="mt-1 w-full p-2 border rounded-md">
            </div>
            <div>
                <label for="address-city" class="text-sm font-medium text-gray-700">City</label>
                <input type="text" id="address-city" required class="mt-1 w-full p-2 border rounded-md">
            </div>
            <div>
                <label for="address-phone" class="text-sm font-medium text-gray-700">Phone Number for this Address</label>
                <input type="tel" id="address-phone" required class="mt-1 w-full p-2 border rounded-md">
            </div>
            <div class="pt-4 flex justify-end gap-3">
                <button type="button" id="cancel-btn" class="px-4 py-2 rounded-md bg-gray-200 hover:bg-gray-300">Cancel</button>
                <button type="submit" id="save-address-btn" class="px-6 py-2 rounded-md bg-red-600 text-white hover:bg-red-700 relative flex justify-center items-center">
                    <span class="btn-text">Save</span>
                    <div class="spinner absolute"></div>
                </button>
            </div>
        </form>
    </div>
  </div>

  <div id="custom-message-box" class="message-box">
    <h3 id="message-box-title"></h3>
    <p id="message-box-text"></p>
    <button id="message-box-ok-btn">OK</button>
  </div>

  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <script src="firebase.js"></script>
  <script src="lang.js"></script>
  <script src="profile.js"></script>
</body>
</html>